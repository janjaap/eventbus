!function(e){if("includes"in Array.prototype)e();else{var t=document.createElement("script");t.src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Array.prototype.includes",t.onload=e,t.onerror=function(){console.error("Could not load polyfills script!"),e()},document.head.appendChild(t)}}(function(){!function(e){function __webpack_require__(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,__webpack_require__),s.l=!0,s.exports}var t={};__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}({"./src/middleware/manager.js":function(e,t,r){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function(){function Manager(){_classCallCheck(this,Manager),this.middlewareFunctions={}}return s(Manager,[{key:"createClassEntry",value:function(e){!1==={}.propertyIsEnumerable.call(this.middlewareFunctions,e)&&(this.middlewareFunctions[e]=[])}},{key:"createMethodEntry",value:function(e,t){this.middlewareFunctions[e][t]||(this.middlewareFunctions[e][t]=[])}},{key:"use",value:function(e){var t=this,r=e.constructor.name;this.createClassEntry(r);for(var s=arguments.length,n=Array(s>1?s-1:0),i=1;i<s;i++)n[i-1]=arguments[i];return n.forEach(function(s){Manager.getClassMethodNames(s).forEach(function(n){var i=s[n].bind(s);t.createMethodEntry(r,n),t.middlewareFunctions[r][n].unshift(i(e))})}),Object.keys(this.middlewareFunctions[r]).forEach(function(s){var n=e[s];if(!n)throw new Error("[Manager] Target method '"+s+"' does not exist");var i=n.bind(e),u=t.middlewareFunctions[r][s],o=Manager.compose(u)(i);e[s]=o}),this}}],[{key:"getClassMethodNames",value:function(e){var t=Object.getPrototypeOf(e);return Object.getOwnPropertyNames(t).filter(function(e){return"constructor"!==e})}},{key:"compose",value:function(e){var t=e.length;if(0===t)return function(e){return e};if(1===t)return e[0];var r=e.pop();return function(){return e.reduceRight(function(e,t){return t(e)},r.apply(void 0,arguments))}}}]),Manager}();t.default=n},"./src/pubsub/event-bus.js":function(e,t,r){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function(){function EventBus(){_classCallCheck(this,EventBus),this.defaultTopic="__global__",this.topics={},this.topics[this.defaultTopic]=[]}return s(EventBus,[{key:"createTopic",value:function(e){return this.topicIsCreated(e)||(this.topics[e]=[]),e}},{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultTopic;if(!this.topicIsCreated(t))throw new Error("[EventBus] Cannot publish a message in non-existent topic '"+t+"'");var r=this.topics[t];EventBus.notifySubscribers(r,e)}},{key:"subscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultTopic;if(!this.topicIsCreated(t))throw new Error("[EventBus] Cannot subscribe "+e+" to non-existent topic '"+t+"'");this.topics[t].push(e)}},{key:"topicIsCreated",value:function(e){return{}.propertyIsEnumerable.call(this.topics,e)}}],[{key:"notifySubscribers",value:function(e,t){e.forEach(function(e){return e.process(t)})}}]),EventBus}();t.default=n},"./src/pubsub/message-store.js":function(e,t,r){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function(){function MessageStore(e){_classCallCheck(this,MessageStore),this.defaultTopic=e.defaultTopic,this.store={},this.store[this.defaultTopic]=[]}return s(MessageStore,[{key:"createTopic",value:function(e){this.topicExists(e)||(this.store[e]=[])}},{key:"record",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultTopic;if(!this.topicExists(t))throw new Error("[MessageStore] Cannot record message in non-existent topic '"+t+"'");this.messageIsRecorded(e,t)||this.store[t].push(e)}},{key:"topicExists",value:function(e){return{}.propertyIsEnumerable.call(this.store,e)}},{key:"messageIsRecorded",value:function(e,t){return this.topicExists(t)&&this.store[t].includes(e)}}]),MessageStore}();t.default=n},"./src/pubsub/publisher.js":function(e,t,r){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function(){function Publisher(e,t){if(_classCallCheck(this,Publisher),this.EventBus=t,!this.EventBus.createTopic||!this.EventBus.publish)throw new Error("[Publisher] EventBus object should have 'createTopic' and 'publish' methods");this.topic=this.EventBus.createTopic(e)}return s(Publisher,[{key:"send",value:function(e){this.EventBus.publish(e,this.topic)}}]),Publisher}();t.default=n},"./src/pubsub/pubsub.js":function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MessageStore=t.Subscriber=t.Publisher=t.EventBus=void 0;var s=r("./src/pubsub/event-bus.js"),n=_interopRequireDefault(s),i=r("./src/pubsub/publisher.js"),u=_interopRequireDefault(i),o=r("./src/pubsub/subscriber.js"),a=_interopRequireDefault(o),c=r("./src/pubsub/message-store.js"),l=_interopRequireDefault(c);t.EventBus=n.default,t.Publisher=u.default,t.Subscriber=a.default,t.MessageStore=l.default},"./src/pubsub/subscriber.js":function(e,t,r){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),n=function(){function Subscriber(e,t,r){if(_classCallCheck(this,Subscriber),this.EventBus=r,!this.EventBus.subscribe)throw new Error("[Subscriber] EventBus should have a 'subscribe' method");this.messagesToListenTo=Array.isArray(e)?e:[e],this.callback=t,this.publishedMessages=[],this.needsAllMessagesForCallback=!0}return s(Subscriber,[{key:"requireAllMessages",value:function(e){return this.needsAllMessagesForCallback=e,this}},{key:"setPublished",value:function(e){this.publishedMessages.push(e)}},{key:"isPublished",value:function(e){return this.publishedMessages.includes(e)}},{key:"listensFor",value:function(e){return this.messagesToListenTo.includes(e)}},{key:"subscribeToOne",value:function(e){return this.EventBus.subscribe(this,e),this}},{key:"subscribeToMany",value:function(e){var t=this;return e.forEach(function(e){t.EventBus.subscribe(t,e)}),this}},{key:"process",value:function(e){this.listensFor(e)&&!1===this.isPublished(e)&&(this.setPublished(e),this.needsAllMessagesForCallback?this.allMessagesPublished&&this.callback(e):this.callback(e))}},{key:"allMessagesPublished",get:function(){var e=this;return this.messagesToListenTo.every(function(t){return e.isPublished(t)})}}]),Subscriber}();t.default=n},0:function(e,t,r){r("./src/pubsub/pubsub.js"),e.exports=r("./src/middleware/manager.js")}})});